#!/usr/bin/env bash

~/bin/focus-wezterm-picker $1

settings_file=~/projects/dotfiles/app-launcher/mac-os-settings-list.json

applications=$(
    eza -1 -X --no-quotes \
        ~/Applications/Brave\ Browser\ Apps.localized/ \
        ~/Applications/ \
        /Applications/ \
        /Applications/Utilities/ \
        /System/Applications/ \
        /System/Volumes/Data/Applications/KiCad/ \
        /System/Applications/Utilities/ \
        /System/Library/CoreServices |
        grep ".app$" |
        sed "s/\.app$//g"
)

settings=$(jq -r 'keys[]' $settings_file)

list=$(
    printf "%s\n" "$applications"
    printf "%s\n" "$settings"
)

selected_item=$(echo "$list" | sort -f | choose -f SFMono-Regular -c "83A598" -b "B8BB26")
#selected_item=$(echo "$list" | sort -f | fzf)

if [ ! -z "${selected_item}" ]; then
    url=$(jq -r --arg key "${selected_item}" '.[$key]' "$settings_file")

    if [[ "$url" == "x-apple"* ]]; then
        open "$url"
    else
        open -a "$selected_item"
    fi
fi

#aerospace list-windows --all --format %{window-id} | sort | tail -n 1 | xargs aerospace focus --window-id $1
